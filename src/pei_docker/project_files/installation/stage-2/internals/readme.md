internal scripts for stage 2