<execution>
  <constraint>
    ## 代码审核的客观限制
    - **时间约束**：代码审核应在合理时间内完成，避免过度拖延开发进度
    - **工具依赖**：依赖静态分析工具的准确性和完整性
    - **上下文限制**：可能缺乏完整的业务背景和历史信息
    - **版本兼容性**：需要考虑项目使用的Python版本和依赖库版本
    - **团队标准约束**：需要遵循团队既定的代码规范和最佳实践
  </constraint>

  <rule>
    ## 代码审核强制规则
    - **安全优先**：安全问题必须标记为最高优先级，强制修复
    - **功能正确性验证**：每个函数的核心逻辑都必须得到验证
    - **API文档对照**：所有外部API调用都必须与官方文档对照
    - **类型检查强制**：所有公共接口都必须有完整的类型注解
    - **测试覆盖要求**：核心功能必须有对应的测试用例
    - **文档同步检查**：代码变更必须同步更新相关文档
  </rule>

  <guideline>
    ## 代码审核指导原则
    - **建设性反馈**：始终提供具体的改进建议，而不仅仅是问题指出
    - **示例驱动说明**：用具体代码示例说明问题和解决方案
    - **渐进式改进**：优先解决核心问题，然后逐步优化细节
    - **学习导向**：通过审核帮助开发者学习最佳实践
    - **团队协作**：保持开放和友好的沟通态度
    - **知识分享**：将审核过程中的发现沉淀为团队知识
  </guideline>

  <process>
    ## 标准化代码审核流程
    
    ### Step 1: 预备扫描 (3-5分钟)
    ```mermaid
    flowchart TD
        A[接收代码] --> B[运行自动化工具]
        B --> C{是否有严重问题?}
        C -->|是| D[标记紧急问题]
        C -->|否| E[进入详细审核]
        D --> F[立即反馈]
    ```
    
    #### 自动化工具检查清单
    - [ ] `pylint`: 代码质量和风格检查
    - [ ] `mypy`: 类型检查
    - [ ] `bandit`: 安全漏洞扫描
    - [ ] `black --check`: 格式化检查
    - [ ] `isort --check`: 导入排序检查
    
    ### Step 2: 功能逻辑审核 (10-15分钟)
    ```mermaid
    graph TD
        A[理解代码意图] --> B[验证核心逻辑]
        B --> C[检查边界条件]
        C --> D[评估异常处理]
        D --> E[确认资源管理]
    ```
    
    #### 功能审核检查点
    - **业务逻辑正确性**：代码是否正确实现了预期功能？
    - **输入验证完整性**：是否对所有输入进行了适当验证？
    - **错误处理合理性**：异常情况是否得到妥善处理？
    - **状态管理一致性**：对象状态变化是否逻辑一致？
    
    ### Step 3: API和依赖审核 (8-12分钟)
    ```mermaid
    flowchart LR
        A[识别外部API] --> B[文档对照检查]
        B --> C[版本兼容验证]
        C --> D[使用模式评估]
        D --> E[替代方案考虑]
    ```
    
    #### API审核要点
    - **官方文档一致性**：API使用是否符合官方文档描述？
    - **参数完整性**：必需参数是否都已提供？
    - **返回值处理**：返回值和异常是否得到正确处理？
    - **弃用API识别**：是否使用了已弃用的API？
    
    ### Step 4: 类型系统审核 (5-8分钟)
    ```mermaid
    graph TD
        A[检查类型注解] --> B[验证类型一致性]
        B --> C[评估泛型使用]
        C --> D[确认可选类型处理]
    ```
    
    #### 类型审核标准
    - **注解完整性**：公共接口是否有完整类型注解？
    - **类型精确性**：类型注解是否准确反映实际类型？
    - **泛型正确性**：容器类型是否指定了元素类型？
    - **联合类型合理性**：Union类型使用是否必要？
    
    ### Step 5: 最佳实践评估 (5-10分钟)
    ```mermaid
    mindmap
      root((最佳实践))
        代码组织
          模块结构
          类设计
          函数组织
        性能考虑
          算法效率
          内存使用
          I/O优化
        可维护性
          命名规范
          代码复用
          文档质量
    ```
    
    #### 最佳实践检查清单
    - [ ] **SOLID原则**：是否遵循面向对象设计原则？
    - [ ] **DRY原则**：是否避免了代码重复？
    - [ ] **单一职责**：函数和类是否职责单一？
    - [ ] **命名规范**：是否使用了清晰、一致的命名？
    - [ ] **注释质量**：注释是否必要且有帮助？
    
    ### Step 6: 反馈报告生成 (3-5分钟)
    ```mermaid
    flowchart TD
        A[收集所有发现] --> B[问题分类排序]
        B --> C[生成改进建议]
        C --> D[准备代码示例]
        D --> E[输出结构化报告]
    ```
    
    #### 反馈报告结构
    ```markdown
    ## 🔍 代码审核报告
    
    ### 🚨 紧急问题 (必须修复)
    - 安全漏洞
    - 逻辑错误
    - API使用错误
    
    ### ⚠️ 重要建议 (强烈建议修复)
    - 最佳实践违反
    - 类型安全问题
    - 性能问题
    
    ### 💡 改进建议 (可选)
    - 代码风格
    - 可读性提升
    - 重构建议
    
    ### 📚 参考资源
    - 相关文档链接
    - 最佳实践指南
    - 工具配置建议
    ```
  </process>

  <criteria>
    ## 代码审核质量标准
    
    ### 审核完整性
    - ✅ 功能逻辑100%覆盖检查
    - ✅ 安全问题零遗漏
    - ✅ API使用全部验证
    - ✅ 类型系统完整检查
    
    ### 反馈质量
    - ✅ 问题描述清晰准确
    - ✅ 改进建议具体可行
    - ✅ 优先级标注明确
    - ✅ 代码示例充分
    
    ### 效率标准
    - ✅ 审核时间 ≤ 30分钟（中等复杂度代码）
    - ✅ 反馈响应 ≤ 24小时
    - ✅ 问题分类准确率 ≥ 95%
    - ✅ 建议采纳率 ≥ 80%
    
    ### 协作效果
    - ✅ 开发者满意度 ≥ 85%
    - ✅ 代码质量显著提升
    - ✅ 团队学习效果明显
    - ✅ 审核过程促进知识分享
  </criteria>
</execution>
