<div class="tab-title">
    üíæ Storage Configuration
</div>
<p class="tab-description">
    Configure <strong>Storage</strong> (Stage-2's dynamic system) and <strong>Mounts</strong> (general volume mounts) for both stages.
</p>

<div class="alert alert-info mb-6">
    <strong>üìã Key Concepts:</strong> 
    <strong>Storage</strong> is Stage-2's unique dynamic system for predefined directories (/soft/app, /soft/data, /soft/workspace).
    <strong>Mounts</strong> are general volume mounts that can be defined for any container path.
</div>

<div class="alert alert-warning mb-6">
    <strong>‚ö†Ô∏è Validation Errors:</strong> This tab contains configuration errors that need to be fixed before saving.
</div>

<!-- Stage-2 Dynamic Storage (UNIQUE FEATURE) -->
<div class="card mb-6">
    <div class="card-header">
        üöÄ Stage-2 Dynamic Storage System (Stage-2 ONLY)
    </div>
    <div class="card-content">
        <div class="form-help mb-4">
            Stage-2's unique dynamic storage for predefined directories with smart linking: /soft/xxx ‚Üí /hard/volume/xxx OR /hard/image/xxx
        </div>
        
        <div class="grid grid-1 gap-6">
            <!-- App Storage -->
            <div class="card">
                <div class="card-content">
                    <div class="form-group">
                        <label class="form-label">üì± App Storage (/soft/app)</label>
                        <div class="form-help mb-2">Application files and dependencies - Fixed destination</div>
                        
                        <div class="grid grid-3 gap-4">
                            <!-- Storage Type -->
                            <div class="form-group">
                                <label class="form-label">Storage type:</label>
                                <select class="form-select storage-type" onchange="updateStorageFields(this, 'app'); markConfigurationModified()">
                                    <option value="auto-volume">auto-volume</option>
                                    <option value="manual-volume">manual-volume</option>
                                    <option value="host">host</option>
                                    <option value="image" selected>image (default)</option>
                                </select>
                            </div>
                            
                            <!-- Host Path -->
                            <div class="form-group">
                                <label class="form-label">Host path:</label>
                                <input type="text" class="form-input storage-host-path" disabled style="background-color: #f9fafb; color: #6b7280;" placeholder="/host/path/to/app" onchange="markConfigurationModified()">
                                <div class="form-help text-xs">Only editable when type is 'host'</div>
                            </div>
                            
                            <!-- Volume Name -->
                            <div class="form-group">
                                <label class="form-label">Volume name:</label>
                                <input type="text" class="form-input storage-volume-name" disabled style="background-color: #f9fafb; color: #6b7280;" placeholder="my-app-volume" onchange="markConfigurationModified()">
                                <div class="form-help text-xs">Only editable when type is 'manual-volume'</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Data Storage -->
            <div class="card">
                <div class="card-content">
                    <div class="form-group">
                        <label class="form-label">üìä Data Storage (/soft/data)</label>
                        <div class="form-help mb-2">User data and persistent files - Fixed destination</div>
                        
                        <div class="grid grid-3 gap-4">
                            <!-- Storage Type -->
                            <div class="form-group">
                                <label class="form-label">Storage type:</label>
                                <select class="form-select storage-type" onchange="updateStorageFields(this, 'data'); markConfigurationModified()">
                                    <option value="auto-volume">auto-volume</option>
                                    <option value="manual-volume">manual-volume</option>
                                    <option value="host">host</option>
                                    <option value="image" selected>image (default)</option>
                                </select>
                            </div>
                            
                            <!-- Host Path -->
                            <div class="form-group">
                                <label class="form-label">Host path:</label>
                                <input type="text" class="form-input storage-host-path" disabled style="background-color: #f9fafb; color: #6b7280;" placeholder="/host/path/to/data" onchange="markConfigurationModified()">
                                <div class="form-help text-xs">Only editable when type is 'host'</div>
                            </div>
                            
                            <!-- Volume Name -->
                            <div class="form-group">
                                <label class="form-label">Volume name:</label>
                                <input type="text" class="form-input storage-volume-name" disabled style="background-color: #f9fafb; color: #6b7280;" placeholder="my-data-volume" onchange="markConfigurationModified()">
                                <div class="form-help text-xs">Only editable when type is 'manual-volume'</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Workspace Storage -->
            <div class="card">
                <div class="card-content">
                    <div class="form-group">
                        <label class="form-label">üíº Workspace Storage (/soft/workspace)</label>
                        <div class="form-help mb-2">Development and workspace files - Fixed destination</div>
                        
                        <div class="grid grid-3 gap-4">
                            <!-- Storage Type -->
                            <div class="form-group">
                                <label class="form-label">Storage type:</label>
                                <select class="form-select storage-type" onchange="updateStorageFields(this, 'workspace'); markConfigurationModified()">
                                    <option value="auto-volume">auto-volume</option>
                                    <option value="manual-volume">manual-volume</option>
                                    <option value="host">host</option>
                                    <option value="image" selected>image (default)</option>
                                </select>
                            </div>
                            
                            <!-- Host Path -->
                            <div class="form-group">
                                <label class="form-label">Host path:</label>
                                <input type="text" class="form-input storage-host-path" disabled style="background-color: #f9fafb; color: #6b7280;" placeholder="/host/path/to/workspace" onchange="markConfigurationModified()">
                                <div class="form-help text-xs">Only editable when type is 'host'</div>
                            </div>
                            
                            <!-- Volume Name -->
                            <div class="form-group">
                                <label class="form-label">Volume name:</label>
                                <input type="text" class="form-input storage-volume-name" disabled style="background-color: #f9fafb; color: #6b7280;" placeholder="my-workspace-volume" onchange="markConfigurationModified()">
                                <div class="form-help text-xs">Only editable when type is 'manual-volume'</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="alert alert-info mt-4">
            <strong>üí° Storage Note:</strong> These 3 storage entries are always present and default to 'image' type even when omitted from user_config.yml. They cannot be created or removed - only their storage type and related options can be configured.
        </div>
    </div>
</div>

<!-- Stage-1 Mounts -->
<div class="card mb-6">
            <div class="card-header">
                üèóÔ∏è Stage-1 Mounts (General Volume Mounts)
            </div>
            <div class="card-content">
                <div class="form-group">
                    <label class="form-label">
                        Stage-1 Volume Mounts
                    </label>
                    <div class="form-help mb-4">
                        General volume mounts for Stage-1 image (any paths, user-defined)
                    </div>
                    
                    <div id="stage1-mounts">
                        <!-- Mount entries will be added dynamically -->
                    </div>
                    
                    <button class="btn btn-secondary" onclick="addMount('stage1')">
                        ‚ûï Add mount
                    </button>
                </div>
            </div>
        </div>

<!-- Stage-2 Mounts -->
<div class="card mb-6">
            <div class="card-header">
                üöÄ Stage-2 Mounts (General Volume Mounts)
            </div>
            <div class="card-content">
                <div class="form-group">
                    <label class="form-label">
                        Stage-2 Volume Mounts
                    </label>
                    <div class="form-help mb-4">
                        General volume mounts for Stage-2 image (any paths, user-defined). Stage-2 mounts don't inherit from Stage-1.
                    </div>
                    
                    <div id="stage2-mounts">
                        <!-- Mount entries will be added dynamically -->
                    </div>
                    
                    <button class="btn btn-secondary" onclick="addMount('stage2')">
                        ‚ûï Add mount
                    </button>
                </div>
            </div>
        </div>


<!-- 
IMPORTANT: Script functionality for dynamic tab content
This content is loaded dynamically via fetch() and innerHTML, so <script> tags don't execute properly.
The parent HTML file (active-project.html) should handle script execution after loading this content.

Required functions for proper functionality:

STORAGE FUNCTIONS (Stage-2 Fixed Entries):
- updateStorageFields(selectElement, storageType): Update storage field enabling based on type selection
  * type=auto-volume: Both host_path and volume_name disabled (gray out)
  * type=manual-volume: Enable volume_name field, disable host_path
  * type=host: Enable host_path field, disable volume_name
  * type=image: Both host_path and volume_name disabled (gray out)
- Storage entries are always visible (app, data, workspace) and cannot be created or removed

MOUNT FUNCTIONS (User-Defined Dynamic Entries):
- addMount(stage): Add new mount to stage1-mounts or stage2-mounts with 5 GUI fields ‚Üí 4 YAML fields
- removeMount(button): Remove mount item from list
- updateMountFields(selectElement): Update mount field enabling based on type selection:
  * type=auto-volume: Both host_path and volume_name disabled (gray out)
  * type=manual-volume: Enable volume_name field, disable host_path  
  * type=host: Enable host_path field, disable volume_name
- Mount sections start empty and can be dynamically created/removed

CRITICAL: Due to script-tag bug in dynamic HTML loading, these event handlers must be attached 
after the content is loaded via the parent HTML's JavaScript, not inline script tags.

For implementation example, see the script section in active-project.html switchTab() function.
-->