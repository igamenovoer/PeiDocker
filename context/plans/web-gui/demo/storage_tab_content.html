<div class="tab-title">
    üíæ Storage Configuration
</div>
<p class="tab-description">
    Configure <strong>Storage</strong> (Stage-2's dynamic system) and <strong>Mounts</strong> (general volume mounts) for both stages.
</p>

<div class="alert alert-info mb-6">
    <strong>üìã Key Concepts:</strong> 
    <strong>Storage</strong> is Stage-2's unique dynamic system for predefined directories (/soft/app, /soft/data, /soft/workspace).
    <strong>Mounts</strong> are general volume mounts that can be defined for any container path.
</div>

<div class="alert alert-warning mb-6">
    <strong>‚ö†Ô∏è Validation Errors:</strong> This tab contains configuration errors that need to be fixed before saving.
</div>

<!-- Stage-2 Dynamic Storage (UNIQUE FEATURE) -->
<div class="card mb-6">
    <div class="card-header">
        üöÄ Stage-2 Dynamic Storage System (Stage-2 ONLY)
    </div>
    <div class="card-content">
        <div class="form-help mb-4">
            Stage-2's unique dynamic storage for predefined directories with smart linking: /soft/xxx ‚Üí /hard/volume/xxx OR /hard/image/xxx
        </div>
        
        <div class="grid grid-3 gap-4">
            <!-- App Storage -->
            <div class="form-group">
                <label class="form-label">üì± App Storage (/soft/app)</label>
                <select class="form-select">
                    <option value="auto-volume">Auto Volume (recommended)</option>
                    <option value="manual-volume">Manual Volume</option>
                    <option value="host">Host Directory</option>
                    <option value="image" selected>In-Image Storage</option>
                </select>
                <div class="form-help">Application files and dependencies</div>
                
                <!-- Show additional fields based on selection -->
                <div class="mt-2" style="display: none;" id="app-host-path">
                    <input type="text" class="form-input" placeholder="/host/path/to/app" />
                    <div class="form-help">Host directory path</div>
                </div>
                <div class="mt-2" style="display: none;" id="app-volume-name">
                    <input type="text" class="form-input" placeholder="my-app-volume" />
                    <div class="form-help">Custom volume name</div>
                </div>
            </div>
            
            <!-- Data Storage -->
            <div class="form-group">
                <label class="form-label">üìä Data Storage (/soft/data)</label>
                <select class="form-select">
                    <option value="auto-volume" selected>Auto Volume (recommended)</option>
                    <option value="manual-volume">Manual Volume</option>
                    <option value="host">Host Directory</option>
                    <option value="image">In-Image Storage</option>
                </select>
                <div class="form-help">User data and persistent files</div>
                
                <div class="mt-2" style="display: none;" id="data-host-path">
                    <input type="text" class="form-input" placeholder="/host/path/to/data" />
                    <div class="form-help">Host directory path</div>
                </div>
                <div class="mt-2" style="display: none;" id="data-volume-name">
                    <input type="text" class="form-input" placeholder="my-data-volume" />
                    <div class="form-help">Custom volume name</div>
                </div>
            </div>
            
            <!-- Workspace Storage -->
            <div class="form-group">
                <label class="form-label">üíº Workspace Storage (/soft/workspace)</label>
                <select class="form-select">
                    <option value="auto-volume">Auto Volume</option>
                    <option value="manual-volume">Manual Volume</option>
                    <option value="host" selected>Host Directory</option>
                    <option value="image">In-Image Storage</option>
                </select>
                <div class="form-help">Development and workspace files</div>
                
                <div class="mt-2" id="workspace-host-path">
                    <input type="text" class="form-input" placeholder="/host/path/to/workspace" value="/home/user/workspace" />
                    <div class="form-help">Host directory path</div>
                </div>
                <div class="mt-2" style="display: none;" id="workspace-volume-name">
                    <input type="text" class="form-input" placeholder="my-workspace-volume" />
                    <div class="form-help">Custom volume name</div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Stage-1 Mounts -->
<div class="card mb-6">
            <div class="card-header">
                üèóÔ∏è Stage-1 Mounts (General Volume Mounts)
            </div>
            <div class="card-content">
                <div class="form-group">
                    <label class="form-label">
                        Stage-1 Volume Mounts
                    </label>
                    <div class="form-help mb-4">
                        General volume mounts for Stage-1 image (any paths, user-defined)
                    </div>
                    
                    <div id="stage1-mounts">
                        <div class="list-item">
                            <div class="list-item-content">
                                <div class="grid grid-3 gap-2">
                                    <input type="text" class="form-input" placeholder="Mount name" value="cache_mount">
                                    <select class="form-select">
                                        <option value="auto-volume" selected>Auto Volume</option>
                                        <option value="manual-volume">Manual Volume</option>
                                        <option value="host">Host Directory</option>
                                    </select>
                                    <input type="text" class="form-input" placeholder="Container path" value="/var/cache/apt">
                                </div>
                                <div class="form-help text-xs mt-1">
                                    Mount: cache_mount ‚Üí /var/cache/apt (Auto Volume)
                                </div>
                            </div>
                            <div class="list-item-actions">
                                <button class="btn btn-error btn-sm" onclick="removeMount(this, 'stage1')">
                                    üóëÔ∏è Remove
                                </button>
                            </div>
                        </div>
                        
                        <!-- This mount has errors -->
                        <div class="list-item" style="border-color: #ef4444; background-color: #fef2f2;">
                            <div class="list-item-content">
                                <div class="grid grid-3 gap-2">
                                    <input type="text" class="form-input" placeholder="Mount name" value="bad_mount" style="border-color: #ef4444;">
                                    <select class="form-select" style="border-color: #ef4444;">
                                        <option value="auto-volume">Auto Volume</option>
                                        <option value="manual-volume">Manual Volume</option>
                                        <option value="host" selected>Host Directory</option>
                                    </select>
                                    <input type="text" class="form-input" placeholder="Container path" value="/invalid/path" style="border-color: #ef4444;">
                                </div>
                                <div class="form-error mt-2">
                                    Host directory /nonexistent does not exist ‚Ä¢ Container path contains invalid characters
                                </div>
                            </div>
                            <div class="list-item-actions">
                                <button class="btn btn-error btn-sm" onclick="removeMount(this, 'stage1')">
                                    üóëÔ∏è Remove
                                </button>
                            </div>
                        </div>
                    </div>
                    
                    <button class="btn btn-secondary" onclick="addMount('stage1')">
                        ‚ûï Add Stage-1 Mount
                    </button>
                </div>
            </div>
        </div>

<!-- Stage-2 Mounts -->
<div class="card mb-6">
            <div class="card-header">
                üöÄ Stage-2 Mounts (General Volume Mounts)
            </div>
            <div class="card-content">
                <div class="form-group">
                    <label class="form-label">
                        Stage-2 Volume Mounts
                    </label>
                    <div class="form-help mb-4">
                        General volume mounts for Stage-2 image (any paths, user-defined). Stage-2 mounts don't inherit from Stage-1.
                    </div>
                    
                    <div id="stage2-mounts">
                        <div class="list-item">
                            <div class="list-item-content">
                                <div class="grid grid-3 gap-2">
                                    <input type="text" class="form-input" placeholder="Mount name" value="user_data">
                                    <select class="form-select">
                                        <option value="auto-volume">Auto Volume</option>
                                        <option value="manual-volume">Manual Volume</option>
                                        <option value="host" selected>Host Directory</option>
                                    </select>
                                    <input type="text" class="form-input" placeholder="Container path" value="/home/me">
                                </div>
                                <div class="form-help text-xs mt-1">
                                    Mount: user_data ‚Üí /home/me (Host Directory: /home/user/data)
                                </div>
                            </div>
                            <div class="list-item-actions">
                                <button class="btn btn-error btn-sm" onclick="removeMount(this, 'stage2')">
                                    üóëÔ∏è Remove
                                </button>
                            </div>
                        </div>
                    </div>
                    
                    <button class="btn btn-secondary" onclick="addMount('stage2')">
                        ‚ûï Add Stage-2 Mount
                    </button>
                </div>
            </div>
        </div>

<!-- Configuration Preview -->
<div class="card mt-6">
    <div class="card-header">
        üìã Storage & Mount Configuration Preview
    </div>
    <div class="card-content">
        <div class="grid grid-3">
            <div>
                <h4 class="form-label mb-2">Stage-2 Dynamic Storage</h4>
                <div class="preview-panel">
                    <div class="font-mono text-sm">
                        <div class="mb-2"><strong>Smart Linking System:</strong></div>
                        <div>/soft/app ‚Üí /hard/image/app</div>
                        <div>/soft/data ‚Üí /hard/volume/data</div>
                        <div>/soft/workspace ‚Üí /hard/volume/workspace</div>
                        <div class="mt-2 text-xs" style="color: #666;">
                            (Links automatically to volume or in-image)
                        </div>
                    </div>
                </div>
            </div>
            <div>
                <h4 class="form-label mb-2">Stage-1 Mounts</h4>
                <div class="preview-panel">
                    <div class="font-mono text-sm">
                        <div>-v cache_mount_vol:/var/cache/apt</div>
                        <div style="color: #ef4444;">-v /nonexistent:/invalid/path</div>
                        <div class="mt-2 text-xs" style="color: #666;">
                            (General volume mounts)
                        </div>
                    </div>
                </div>
            </div>
            <div>
                <h4 class="form-label mb-2">Stage-2 Mounts</h4>
                <div class="preview-panel">
                    <div class="font-mono text-sm">
                        <div>-v /home/user/data:/home/me</div>
                        <div class="mt-2 text-xs" style="color: #666;">
                            (Don't inherit from Stage-1)
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="mt-4">
            <h4 class="form-label mb-2">YAML Configuration Preview</h4>
            <div class="preview-panel">
                <div class="font-mono text-sm">
                    <div><strong>stage_2:</strong></div>
                    <div>&nbsp;&nbsp;<strong>storage:</strong></div>
                    <div>&nbsp;&nbsp;&nbsp;&nbsp;<strong>app:</strong> { type: image }</div>
                    <div>&nbsp;&nbsp;&nbsp;&nbsp;<strong>data:</strong> { type: auto-volume }</div>
                    <div>&nbsp;&nbsp;&nbsp;&nbsp;<strong>workspace:</strong> { type: host, host_path: "/home/user/workspace" }</div>
                    <div>&nbsp;&nbsp;<strong>mount:</strong></div>
                    <div>&nbsp;&nbsp;&nbsp;&nbsp;<strong>user_data:</strong> { type: host, dst_path: "/home/me", host_path: "/home/user/data" }</div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- 
IMPORTANT: Script functionality for dynamic tab content
This content is loaded dynamically via fetch() and innerHTML, so <script> tags don't execute properly.
The parent HTML file (active-project.html) should handle script execution after loading this content.

Required functions for proper functionality:
- addMount(stage): Add new mount to stage1-mounts or stage2-mounts
- removeMount(button, stage): Remove mount item from list
- Storage type change handlers for app/data/workspace storage dropdowns

For implementation example, see the script section in active-project.html switchTab() function.
-->